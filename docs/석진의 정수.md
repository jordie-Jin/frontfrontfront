# 석진의 정수

이 문서는 SENTINEL 프론트엔드 폴더에서 진행한 작업의 핵심을 한 파일로 압축한 회고이자 운영 문서다.  
기준 기간은 현재 저장소에 기록된 이력 중심(2026-02-04 ~ 2026-02-20)이다.

## 1. 한 줄 정리

SENTINEL 프론트의 본질은 “권한 기반 운영 UX + 비동기 API 안정화 + 실패 시 복구 가능성”을 실제 사용자 흐름에서 끊기지 않게 만든 작업이었다.

## 2. 무엇을 만들고 고쳤는가 (핵심 결과)

1. 관리자/사용자 역할 기반 UI 분기 체계를 실제 업무 흐름에 맞춰 정리했다.
2. Q&A를 작성/수정/삭제/답변까지 실사용 가능한 상태로 API와 맞췄다.
3. 공지사항 상세 모달 내 수정, 첨부 업로드/다운로드, 프리사인/302 대응을 완료했다.
4. 협력사 목록/상세/대시보드에서 API 실패 시 폴백 데이터와 배너로 서비스 연속성을 확보했다.
5. AI 리포트 생성 요청-상태 폴링-완료 다운로드까지 비동기 흐름을 안정화했다.
6. 기존 보고서 즉시 다운로드(선다운로드 우선)로 대기시간과 중복 작업을 줄였다.
7. 대시보드 KPI를 summary 단일 소스로 정리해 카드 6개 매핑/단위/라벨 정합을 맞췄다.
8. 회사 식별자를 `companyId`로 통일해 API/문서/코드 간 혼선을 줄였다.
9. 회원가입 필수 약관 동의 게이트와 정책/약관 모달화로 가입 UX와 컴플라이언스 맥락을 동시에 잡았다.
10. 미사용 서비스/타입/유틸/목 라우트를 제거해 코드베이스 복잡도를 낮췄다.

## 3. 직면한 문제와 해결법 (문제-해결-효과)

1. 문제: 관리자 관점 전환 시 화면 이동이 많아 운영 속도가 느렸다.  
   해결: 같은 화면에서 사용자 컨텍스트만 전환하도록 설계했다.  
   효과: 화면 전환/재탐색 비용 감소, 비교 업무 속도 개선.

2. 문제: Q&A API 필드/경로 불일치로 답변 노출이 불안정했다.  
   해결: 관리자 답변 경로 정규화, `content` 전송 고정, `name/content` 매핑 보강, userId 쿼리 제거를 반영했다.  
   효과: 사용자/관리자 화면의 답변 표시 일관성 개선.

3. 문제: 일부 환경에서 사용자 ID가 숫자/문자열 혼용되어 선택/전환 오류가 났다.  
   해결: 비교/전달 타입 정규화 로직을 적용했다.  
   효과: 관리자 사용자 전환 정확도 향상.

4. 문제: 첨부파일 다운로드에서 리다이렉트/프리사인 URL 케이스가 실패했다.  
   해결: 파일 URL 조회 후 다운로드 처리로 흐름을 분리했다.  
   효과: 공지 첨부 다운로드 성공률 개선.

5. 문제: AI 리포트 생성은 비동기라 완료 시점을 사용자가 알기 어려웠다.  
   해결: `requestId` 기반 폴링, 상태 메시지, 완료 시 자동 다운로드를 넣었다.  
   효과: “생성됨” 이후 행동이 명확해지고 사용자 대기 불확실성 감소.

6. 문제: 이미 있는 리포트도 다시 생성 요청되어 지연/중복이 발생했다.  
   해결: 선다운로드 우선 로직으로 기존 산출물은 즉시 다운로드, 미생성(404/409)만 생성 요청하도록 분기했다.  
   효과: 체감 속도 개선, 중복 요청 감소.

7. 문제: 외부 건강도 표기가 0~1 vs 0~100 혼선으로 신뢰를 떨어뜨렸다.  
   해결: 스케일 처리 기준을 정리하고 서버 값 해석을 일관화했다.  
   효과: 지표 해석 일치, 오해 감소.

8. 문제: API 장애 시 화면이 비거나 오작동처럼 보였다.  
   해결: 목록/상세/대시보드/Q&A에 폴백 데이터 + 안내 배너 + 재시도 흐름을 넣었다.  
   효과: 데모/운영 상황에서 서비스 연속성 확보.

9. 문제: 대시보드 KPI가 여러 소스에 의존해 값 불일치가 발생했다.  
   해결: `summary.kpis` 단일 소스로 정리하고 라벨/단위를 통일했다.  
   효과: 지표 신뢰성과 유지보수성 동시 개선.

10. 문제: 회원가입 중 정책 확인 흐름이 끊기고 레이어 충돌이 있었다.  
    해결: 약관 모달 z-index 보정, 필수 동의 전 입력 비활성화 게이트를 도입했다.  
    효과: 가입 실패/혼란 감소, 법적 동의 흐름 명확화.

## 4. 고찰: 이번 작업의 본질

1. 프론트의 핵심은 “보여주는 코드”가 아니라 “실패했을 때도 이어지는 사용자 흐름”이다.
2. API 정규화는 단순 경로 치환이 아니라, 팀 간 계약 비용을 줄이는 구조 작업이다.
3. 모달 중심 편집은 화려함보다 맥락 유지에 강하고, 운영형 서비스에서 특히 유효했다.
4. 역할 분기는 UI 장식이 아니라 권한 리스크를 줄이는 안전장치다.
5. 지표 화면은 수치보다 “해석 일관성”이 먼저이며, 라벨/단위/스케일 정합이 신뢰를 만든다.
6. 문서화는 부가 작업이 아니라 다음 작업자의 비용을 줄이는 생산성 장치다.

## 5. 트레이드오프와 한계

1. 폴백 데이터는 연속성을 주지만, 실제 데이터와 혼동될 수 있어 배너/표시 규칙 관리가 필수다.
2. 로컬 병합(예: Q&A replies 누락 대응)은 즉시성에는 유리하지만 장기적으로 서버 응답 계약 보완이 필요하다.
3. 폴링 방식은 구현이 단순하지만, 장기적으로는 SSE/WebSocket 대비 네트워크 효율이 낮다.
4. 빠른 대응 중심의 다수 핫픽스는 구조 개선과 함께 가지 않으면 재발 위험이 있다.

## 6. 남아 있는 이슈와 리스크

1. 관리자 답변 등록 후 서버 재조회 응답에서 `replies` 미포함 시 로컬 병합 의존 구간이 남아 있다.
2. 관리자 API의 `userId` 파라미터 최종 규격은 백엔드와 고정 합의가 필요하다.
3. UX 정량 지표는 현재 시뮬레이션 기반이며, 운영 로그 기반 보정이 추가되어야 한다.

## 7. 다음 단계 제안

1. Q&A 답변 반영을 서버 응답 기준으로 완전 전환하고 로컬 병합을 축소한다.
2. 관리자 전환/공지 수정/리포트 생성 플로우에 대해 E2E 시나리오 테스트를 고정한다.
3. 에러 코드별 사용자 메시지 가이드를 공통화해 화면별 편차를 줄인다.
4. UX 정량 지표를 실제 로그(클릭 수, 이탈률, 복구 시간)로 치환해 발표 데이터 신뢰도를 높인다.

## 8. 참고 문서

1. `docs/frontend-ux-strategy.md`
2. `docs/backend-api-normalization-apply-report.md`
3. `docs/ai-report-download.md`
4. `docs/frontend-presentation-qa.md`
5. `.context.md`

